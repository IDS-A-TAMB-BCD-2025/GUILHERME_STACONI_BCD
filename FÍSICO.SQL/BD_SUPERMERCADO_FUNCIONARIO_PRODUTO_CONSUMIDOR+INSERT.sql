USE BD_SUPERMERCADO_FUNCIONARIO_PRODUTO_CONSUMIDOR;

INSERT INTO SUPERMERCADO (SUP_CNPJ, SUP_RAZAO_SOCIAL, SUP_TELEFONE, SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES 
("12345678000101", "Supermercado Grick", "199999999" ,"gricktambau@email.com", "Grick Street", "10000", "TambaCity", "SP"),
("98765432000199", "Supermercado Bela Vista", "(11) 3456-7890", "contato@belavista.com", "Rua das Flores", "250", "Campinas", "SP"),
("11223344000155", "Supermercado Econômico", "(16) 4002-8922", "economico@mercados.com", "Avenida Brasil", "1450", "Ribeirão Preto", "SP"),
("22334455000177", "Supermercado Popular", "(43) 3222-1188", "popular@mercados.com", "Rua XV de Novembro", "800", "Londrina", "PR"),
("33445566000188", "Supermercado União", "(31) 98888-7777", "uniao@mercados.com", "Rua Central", "320", "Belo Horizonte", "MG");

INSERT INTO PRODUTO (PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES 
("7891234567890", "Arroz 5kg", "5.0", "500", "26.90", "2025-12-25"), 
("7896543210123", "Feijão Carioca 1kg", "1.0", "300", "8.50", "2026-01-10"),
("7899876543210", "Açúcar Refinado 2kg", "2.0", "400", "7.20", "2026-02-05"),
("7891112223334", "Café Torrado e Moído 500g", "0.5", "250", "12.90", "2025-11-30"),
("7895556667778", "Macarrão Espaguete 1kg", "1.0", "350", "6.30", "2026-03-15");

INSERT INTO CONSUMIDOR (CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES
("44627578822", "Guilherme", "99195131", "guilhermestaconidossantos@gmail.com"),
("51233498700", "Bruna", "989652340", "bruna.figueira@gmail.com"),
("39874512066", "João Pereira", "998877665", "joao.pereira@hotmail.com"),
("22569874123", "Ana Souza", "997744332", "ana.souza@yahoo.com"),
("78945612309", "Lucas Fernandes", "996655443", "lucas.fernandes@gmail.com");

INSERT INTO FUNCIONARIO (FUN_CPF, FUN_NOME, FUN_DATA_NASCIMENTO, FUN_TELEFONE, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATA_ADMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES
("98765432100","José Vanderelei", "1985-03-12", "11987654321", "ze_vanderlei@email.com", "carteira_ze_vanderlei.pdf", "1234", "56789", "2020-01-15", "44 horas", "12345678000101"),
("45678912300", "Maria Oliveira", "1992-08-10", "11998877665", "maria.oliveira@email.com", "carteira_maria.pdf", "4321", "11223", "2021-03-20", "40 horas", "98765432000199"),
("32165498700", "Carlos Mendes", "1985-03-05", "21997766554", "carlos.mendes@email.com", "carteira_carlos.pdf", "5678", "33445", "2019-07-10", "44 horas", "11223344000155"),
("65498732100", "Fernanda Lima", "1995-11-18", "11996655443", "fernanda.lima@email.com", "carteira_fernanda.pdf", "8765", "99887", "2022-09-01", "36 horas", "22334455000177"),
("78932165400", "Paulo Ricardo", "1988-02-27", "31995544332", "paulo.ricardo@email.com", "carteira_paulo.pdf", "3456", "22334", "2023-05-12", "44 horas", "33445566000188");

INSERT INTO SUPERMERCADO_PRODUTO (FK_CON_CPF, FK_PRO_ID)
VALUES
("44627578822", 1),
("51233498700", 2),
("39874512066", 3),
("22569874123", 4),
("78945612309", 5);

INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES
("44627578822", 2),
("51233498700", 5),
("39874512066", 1),
("22569874123", 3),
("78945612309", 4);

SELECT * FROM SUPERMERCADO;

/*
CONSULTAR O AUMENTO DE R$ 2,00 NO PREÇO DOS PRODUTOS 
COM PREÇO ATUAL DE >= R$ 5,00
*/
SELECT	PRO_NOME AS "NOME",
		PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
        PRO_PRECO AS "PREÇO ATUAL",
        TRUNCATE((PRO_PRECO + 2),2) AS "PREÇO COM AJUSTE DE R$ 2,00"
FROM	PRODUTO
WHERE 	PRO_PRECO >= 5;

/*
CONSULTAR A REDUÇÃO DE R$ 1,00 NO PREÇO DOS PRODUTOS 
COM PREÇO ATUAL ABAIXO DE R$ 5,00
*/
SELECT	PRO_NOME AS "NOME",
		PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
        PRO_PRECO AS "PREÇO ATUAL",
        TRUNCATE((PRO_PRECO - 1),2) AS "PREÇO COM REDUÇÃO DE R$ 1,00"
FROM	PRODUTO
WHERE 	PRO_PRECO <=10;

/* 
CONSULTAR COMO SERIA APLICAR UM DESCONTO DE 10% EM TODOS OS PRODUTOS
*/
SELECT	PRO_NOME AS "NOME",
		PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
        PRO_PRECO AS "PRECO_ ATUAL",
        (PRO_PRECO - (PRO_PRECO * 0.1)) AS "PREÇO COM DESCONTO DE 10%"
FROM	PRODUTO;

/*
AJUSTAR O ESTOQUE DP PRIMEIRO PRODUTO, DIVIDINDO PELA METADE
*/
SELECT	PRO_ID,
		PRO_NOME,
		PRO_CODIGO_BARRAS,
        PRO_QUANTIDADE
FROM	PRODUTO;

UPDATE	PRODUTO
SET		PRO_QUANTIDADE = PRO_QUANTIDADE/2
WHERE	PRO_ID = 1;

/*
CONSULTAR TODOS OS PRODUTOS QUE TENHAM DATA DE VALIDADE ENTRE
SETEMBRO DE 2025 E DEZEMBRO DE 2025 
*/
SELECT	PRO_NOME AS "NOME",
		PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
        PRO_DATA_VALIDADE AS "DATA DE VALIDADE"
FROM	PRODUTO
WHERE	PRO_DATA_VALIDADE BETWEEN '2025-09-01' AND '2025-12-31';

/*
CONSULTAR TODOS OS PRODUTO QUE TENHAM 
PREÇO MAIOR QUE R$ 10 OU MENOR QUE R$ 4
*/
SELECT	PRO_NOME AS "NOME",
		PRO_CODIGO_BARRAS  AS "CÓDIGO DE BARRAS",
        PRO_PRECO AS "PREÇO"
FROM	PRODUTO
WHERE	PRO_PRECO >= 10 OR PRO_PRECO <= 4;

/*
CONSULTAR OS DDS E TELEFONE DOS CONSUMIDORES SEPARADAMENTE
*/
SELECT	CON_NOME AS "NOME DO CONSUMIDOR",
		CON_CPF  AS "CPF DO CONSUMIDOR",
        SUBSTRING(CON_TELEFONE,1,2) AS "DDD DO TELEFONE",
        SUBSTRING(CON_TELEFONE,3,9) AS "NÚMERO DO TELEFONE"
FROM 	CONSUMIDOR;

/*
GERAR UAM FRASE CONCATENANDO:
'RAZÃO SOCIAÇ, CNPJ, TELEFONE E EMAIL
*/
SELECT	CONCAT("Razão social: ", SUP_RAZAO_SOCIAL)
FROM 	SUPERMERCADO;

/*
GERAR UMA FRASE CONCATENANDO:
RAZÃO SOCIAL, CNPJ, TELEFONE E EMAIL
*/
SELECT	CONCAT("Razão Social: ",
				CONCAT(SUP_RAZAO_SOCIAL,
					CONCAT(" | CNPJ: ",
						CONCAT(SUP_CNPJ,
							CONCAT(" | Telefone: ",
								CONCAT(SUP_TELEFONE,
									CONCAT(" | Email ", SUP_EMAIL))))))) AS FRASE
FROM	SUPERMERCADO;

/*
GERAR UMA CONSULTAQUE VERIFICA O STATUS DO ESTOQUE DOS PRODUTOS.
REGRAS:
1) QUANTIDADE <= 25: ESTOQUE BAIXO
2) QUANTIDADE > 25 E QUANTIDADE <= 100: ESTOQUE MÉDIO
*/

SELECT	PRO_NOME AS "NOME DO PRODUTO",
		PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
		PRO_QUANTIDADE AS "QUANTIDADE",
        PRO_DATA_VALIDADE AS "DATA DE VALIDADE",
        PRO_PRECO AS "PESO DO PRODUTO",
        CASE 
			WHEN PRO_PESO <= 5 THEN "PESO BAIXO"
			WHEN PRO_PESO > 5 AND PRO_PESO <= 50 THEN "PESO MÉDIO"
            WHEN PRO_PESO > 50 THEN "PESO ALTO"
		END AS "CLASSIFICAÇÃO DO PESO"
FROM	PRODUTO;

/*
CONTAR QUANTOS CONSUMIDORES TEMOS CADASTRADOS
*/
SELECT	COUNT(*)
FROM	CONSUMIDOR;

/*
CONTAR QUANTOS SUPERMERCADOS TEMOS CASDASTRADOS
*/
SELECT	COUNT(*)
FROM	SUPERMERCADO;

/*
CONTAR QUANTOS FUNCIONARIOS TEMOS CASDASTRADOS
*/
SELECT	COUNT(*)
FROM	FUNCIONARIO;

/*
CONTAR QUANTOS SUPERMERCADOS TEMOS CASDASTRADOS
*/
SELECT	COUNT(*)
FROM	SUPERMERCADO;

/*
SOMAR O PREÇO TOTAL DE TODOS OS PRODUTOS CADASTRADOS
*/
SELECT	SUM(PRO_PRECO)
FROM	PRODUTO;

SELECT	CONCAT("R$ ",TRUNCATE(SUM(PRO_PRECO),2)) AS "SOMA TOTAL"
FROM	PRODUTO;

/*
CALCULAR A MÉDIA DOS PRODUTOS
*/
SELECT 	AVG(PRO_PRECO)
FROM	PRODUTO;

SELECT 	CONCAT("R$ ",TRUNCATE(AVG(PRO_PRECO),2)) AS "MÉDIA DO PREÇO"
FROM	PRODUTO;

/*
SELECIONAR O PRODUTO MAIS CARO
*/
SELECT	MAX(PRO_PRECO)
FROM	PRODUTO;

/*
SELECIONAR O ESTOQUE COM MAIOR QUANTIDADE
*/
SELECT	MAX(PRO_QUANTIDADE)
FROM	PRODUTO;

/*
SELECIONARO PRODUTO MAIS BARATO
*/
SELECT	MIN(PRO_PRECO)
FROM	PRODUTO;

/*
SELECIONAR O ESTOQUE COM MENOR QUANTIDADE
*/
SELECT	MIN(PRO_QUANTIDADE)
FROM	PRODUTO;

/*
SELECIONAR A DATA E HORA ATUAL
*/
SELECT	NOW() FROM DUAL;

SELECT 	FUN_NOME AS "NOME DO FUNCIONÁRIO",
		DATE_FORMAT(FUN_DATA_NASCIMENTO, "%d/%m/%Y") AS "DTA DE NASCIMENTO",
        TIMESTAMPDIFF(YEAR,FUN_DATA_NASCIMENTO,NOW()) AS "IDADE"
FROM	FUNCIONARIO;

/*
FUNÇÕES MATEMÁTICAS:
ABS - VALOR ABSOLUTO DE UM NÚMERO
ROUND - ARREDONDAR
POWER - POTÊNCIA
*/
SELECT	ABS(-10),
		ROUND(PRO_PRECO) AS "PREÇO ARREDONDADO",
        POWER(PRO_PRECO,2) AS "PREÇOS ELEVADOS AO QUADRADO"
FROM	PRODUTO;

/*
UPPER, LOWER, TRIM
*/
SELECT	UPPER(FUN_NOME) AS "MAIÚSCULAS",
		LOWER(FUN_NOME)  AS "MINÚSCULAS",
        TRIM("			Gabriel") AS "TIRANDO ESPAÇOS"
FROM	FUNCIONARIO;

SELECT 	C.CON_NOME,
		P.PRO_NOME
FROM 	PRODUTO_CONSUMIDOR PC
JOIN 	CONSUMIDOR C 	ON (C.CON_CPF = PC.FK_CON_CPF)
JOIN 	PRODUTO P 		ON (P.PRO_ID = PC.FK_PRO_ID);


SELECT		F.FUN_NOME,
			S.SUP_RAZAO_SOCIAL
FROM		FUNCIONARIO F
LEFT JOIN	SUPERMERCADO S ON (S.SUP_CNPJ = F.FK_SUP_CNPJ);

SELECT * FROM FUNCIONARIO;

SELECT		C.CON_NOME,
			P.PRO_NOME
FROM		CONSUMIDOR C
LEFT JOIN 	PRODUTO_CONSUMIDOR PC 	ON (C.CON_CPF = PC.FK_CON_CPF)
LEFT JOIN	PRODUTO P				ON (P.PRO_ID   = PC.FK_PRO_ID);

SELECT		P.PRO_NOME,
			C.CON_NOME			
FROM		PRODUTO P
LEFT JOIN 	PRODUTO_CONSUMIDOR PC 	ON (P.PRO_ID  = PC.FK_PRO_ID)
LEFT JOIN	CONSUMIDOR C			ON (C.CON_CPF = PC.FK_CON_CPF);

SELECT 		S.SUP_RAZAO_SOCIAL,
			P.PRO_NOME
FROM 		SUPERMERCADO S
RIGHT JOIN 	SUPERMERCADO_PRODUTO SP ON (SP.FK_SUP_CNPJ 	= S.SUP_CNPJ)
RIGHT JOIN 	PRODUTO P 				ON (SP.FK_PRO_ID 	= P.PRO_ID);

SELECT 		C.CON_NOME,
			P.PRO_NOME
FROM 		CONSUMIDOR C
RIGHT JOIN 	PRODUTO_CONSUMIDOR PC 	ON (PC.FK_CON_CPF	= C.CON_CPF)
RIGHT JOIN 	PRODUTO P 				ON (PC.FK_PRO_ID = P.PRO_ID);

SELECT		F.FUN_NOME,
			S.SUP_RAZAO_SOCIAL 
FROM		FUNCIONARIO F
RIGHT JOIN	SUPERMERCADO S ON (S.SUP_CNPJ = F.FK_SUP_CNPJ);

SELECT 		S.SUP_RAZAO_SOCIAL,
			P.PRO_NOME
FROM 		SUPERMERCADO S
RIGHT JOIN 	SUPERMERCADO_PRODUTO SP ON (SP.FK_SUP_CNPJ 	= S.SUP_CNPJ)
RIGHT JOIN 	PRODUTO P 				ON (SP.FK_PRO_ID 	= P.PRO_ID);

SELECT 		C.CON_NOME,
			P.PRO_NOME
FROM 		CONSUMIDOR C
RIGHT JOIN 	PRODUTO_CONSUMIDOR PC 	ON (PC.FK_CON_CPF	= C.CON_CPF)
RIGHT JOIN 	PRODUTO P 				ON (PC.FK_PRO_ID = P.PRO_ID);


